if (!require("FactoMineR")) install.packages("FactoMineR"); library(FactoMineR)
gbm<-read.csv("VarImpTable_GBM.csv")
rf<-read.csv("VarImpTable_rf.csv")
setwd("E:/spain/BGSE/term 2/kaggle")
source("1 kaggle_load.R")
source("1 kaggle_load.R")
omit<-c("id", "url", "popularity")
df2.norm<-as.data.frame(lapply(df2[,setdiff(names(df2), omit)], normalize))
df2.norm<-cbind(df2.norm, df2[,omit])
df2.norm$url<-as.character(df2.norm$url)
df2.norm$urlLength<-nchar(df2.norm$url[1])
df2.norm$time = substr(df2.norm$url,21,30); df2.norm$url<-NULL; df2.norm$id<-NULL
df2.norm$time <-ymd(df2.norm$time)
df2.norm$year <- factor(year(df2.norm$time))
df2.norm$month <-factor(month(df2.norm$time, label=TRUE, abbr=TRUE), ordered=FALSE)
df2.norm$time <-as.numeric(df2.norm$time)
dfDummy.norm <- dummyVars("~.",data=df2.norm, fullRank=F)
df2.norm <- as.data.frame(predict(dfDummy.norm,df2.norm))
print(names(df2.norm))
write.csv(df2.norm,"#data sets/df2.norm.csv")
rm(list=ls())
if (!require("FactoMineR")) install.packages("FactoMineR"); library(FactoMineR)
gbm<-read.csv("VarImpTable_GBM.csv")
setwd("~/GitHub/Kaggle/news_popularity/kaggle report")
gbm<-read.csv("VarImpTable_GBM.csv")
rf<-read.csv("VarImpTable_rf.csv")
df2.norm<-read.csv("df2.norm.csv")
df3<-read.csv("df2.norm.csv")
df3$popularity<-as.factor(df3$popularity)
head(gbm)
gbm_name<-as.vector(gbm[1:25,1]) #variables with weights higher than 10
e<-match(gbm_name, names(df3))
df3<-df3[,c(e,ncol(df3))]
nullify <- c("time", "timedelta", "kw_max_avg", "kw_max_min", "kw_min_avg", "n_unique_tokens", "self_reference_min_shares")
df3<-df3[,setdiff(names(df3), nullify)]
pca<-PCA(df3, quali.sup=ncol(df3))
plot(pca, cex=0.5, habillage=ncol(df3))
plot(pca, habillage=ncol(df3), invisible="ind")
plot(pca, choix="var", cex=0.8, select=" contrib 10") #top 10 (threshold chosen stepwise)
par(mfrow=c(1,2))
plot(pca, choix="var", cex=0.8, select=" contrib 10") #top 10 (threshold chosen stepwise)
plot(pca, habillage=ncol(df3), invisible="ind")
names(df3)
rm(list=ls())
gbm<-read.csv("VarImpTable_GBM.csv")
rf<-read.csv("VarImpTable_rf.csv")
df3<-read.csv("df2.norm.csv")
str(df3)
df3$popularity<-as.factor(df3$popularity)
gbm_name<-as.vector(gbm[1:25,1]) #variables with weights higher than 10
e<-match(gbm_name, names(df3))
df3<-df3[,c(e,ncol(df3))]
str(df3)
rm(list=ls())
gbm<-read.csv("VarImpTable_GBM.csv")
rf<-read.csv("VarImpTable_rf.csv")
df3<-read.csv("df2.norm.csv")
outcome<-df3$popularity
head(gbm)
gbm_name<-as.vector(gbm[1:25,1]) #variables with weights higher than 10
e<-match(gbm_name, names(df3))
e
df3<-cbind(df3[,e],outcome)
str(Df3)
str(df3)
popularity<-df3$popularity
gbm_name<-as.vector(gbm[1:25,1]) #variables with weights higher than 10
e<-match(gbm_name, names(df3))
df3<-cbind(df3[,e],outcome)
str(df3)
rm(list=ls())
gbm<-read.csv("VarImpTable_GBM.csv")
rf<-read.csv("VarImpTable_rf.csv")
df3<-read.csv("df2.norm.csv")
popularity<-df3$popularity
head(gbm)
gbm_name<-as.vector(gbm[1:25,1]) #variables with weights higher than 10
e<-match(gbm_name, names(df3))
df3<-cbind(df3[,e],outcome)
